{"version":3,"sources":["webpack:///node_modules/@arcgis/core/layers/support/rasterDatasets/RawBlockCache.js","webpack:///node_modules/@arcgis/core/layers/support/rasterFunctions/rasterProjectionHelper.js","webpack:///node_modules/@arcgis/core/layers/support/rasterDatasets/EphemeralBlockCache.js"],"names":["c","Map","a","i","e","t","s","n","extent","rasterInfo","cache","has","get","push","length","set","u","f","h","decreaseRefCount","o","r","refCount","controller","abort","m","getBlock","block","x","putBlock","l","isResolved","isRejected","then","d","deleteBlock","y","xmin","xmax","ymin","ymax","g","clone","normalize","p","spatialReference","k","transform","M","Set","inverseTransform","pyramidLevel","pyramidResolution","excessiveReading","R","storageInfo","C","origin","j","Math","max","floor","v","ceil","B","b","pyramidBlockWidth","blockWidth","w","pyramidBlockHeight","blockHeight","$","I","H","E","P","add","forEach","isWGS84","isWebMercator","equals","center","isGeographic","valid","abs","map","filter","isNaN","apply","min","cols","rows","N","S","z","W","G","NaN","L","Float32Array","q","A","offsets","error","coefficients","spacing","size","log","pixelSize","LN2","maximumPyramidLevel","round","pow","nativePixelSize","projectedPixelSize","scales","srcResolutions","width","height","_timer","_cachedBlocks","_size","_duration","_interval","ts","Date","now","trim","updateTimer","clear","clearTimer","setInterval","Array","from","clearInterval"],"mappings":"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","file":"default~ImageryTileLayer-js~layers-ImageryTileLayerView2D-js-es5.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import t from\"../../../geometry/Point.js\";import\"../../../geometry.js\";import n from\"./EphemeralBlockCache.js\";import{projectExtent as o,projectResolution as r,snapPyramid as l}from\"../rasterFunctions/rasterProjectionHelper.js\";const c=new Map,a=new n;function i(e,t){return null==t?e:`${e}?sliceId=${t}`}function s(e,t){const n={extent:null,rasterInfo:t,cache:new Map};if(c.has(e)){const t=c.get(e);return t.push(n),t.length-1}return c.set(e,[n]),0}function u(e,t){if(c.has(e)){c.get(e)[t]=null}}function f(e){c.delete(e)}function h(e,t,n){if(!c.has(e))return null==t?a.decreaseRefCount(e,n):0;const o=c.get(e);if(null==o[t])return a.decreaseRefCount(e,n);const r=o[t].cache;if(r.has(n)){const e=r.get(n);if(e.refCount--,0===e.refCount){r.delete(n);for(let e=0;e<o.length;e++)o[e]&&o[e].cache.has(n)&&o[e].cache.delete(n);e.controller&&e.controller.abort()}return e.refCount}return 0}function m(e,t,n){if(!c.has(e))return null==t?a.getBlock(e,n):null;const o=c.get(e);if(null==o[t]){for(let e=0;e<o.length;e++)if(o[e]&&o[e].cache.has(n)){const t=o[e].cache.get(n);return t.refCount++,t.block}return a.getBlock(e,n)}const r=o[t].cache;if(r.has(n)){const e=r.get(n);return e.refCount++,e.block}for(let e=0;e<o.length;e++)if(e!==t&&o[e]&&o[e]&&o[e].cache.has(n)){const t=o[e].cache.get(n);return t.refCount++,r.set(n,t),t.block}return null}function x(e,t,n,o,r=null){if(!c.has(e))return void(null==t&&a.putBlock(e,n,o,r));const l=c.get(e);if(null==l[t])return void a.putBlock(e,n,o,r);const i={refCount:1,block:o,isResolved:!1,isRejected:!1,controller:r};o.then((()=>i.isResolved=!0)).catch((()=>i.isRejected=!0)),l[t].cache.set(n,i)}function d(e,t,n){if(!c.has(e))return void(null==t&&a.deleteBlock(e,n));const o=c.get(e);null!=o[t]?o[t].cache.delete(n):a.deleteBlock(e,n)}function y(n,a,i,s,u,f,h=null){const m=function(e,t){if(!c.has(e))return null;const n=c.get(e);return null==n[t]?null:n[t]}(n,a),x=m.extent,{cache:d,rasterInfo:y}=m;if(x&&x.xmin===i.xmin&&x.xmax===i.xmax&&x.ymin===i.ymin&&x.ymax===i.ymax)return;const g=i.clone().normalize(),{spatialReference:p,transform:k}=y,M=new Set;for(let n=0;n<g.length;n++){const c=g[n];if(c.xmax-c.xmin<=s||c.ymax-c.ymin<=s)continue;let a=o(c,p,h);e(k)&&(a=k.inverseTransform(a));const i=new t({x:s,y:s,spatialReference:c.spatialReference});if(null===u&&!(u=r(i,p,c,h)))return;const{pyramidLevel:m,pyramidResolution:x,excessiveReading:d}=l(u,y,f||\"closest\");if(d)return;const{storageInfo:R}=y,{origin:C}=R,j={x:Math.max(0,Math.floor((a.xmin-C.x)/x.x)),y:Math.max(0,Math.floor((C.y-a.ymax)/x.y))},v=Math.ceil((a.xmax-a.xmin)/x.x-.1),B=Math.ceil((a.ymax-a.ymin)/x.y-.1),b=m>0?R.pyramidBlockWidth:R.blockWidth,w=m>0?R.pyramidBlockHeight:R.blockHeight,$=1,I=Math.max(0,Math.floor(j.x/b)-$),H=Math.max(0,Math.floor(j.y/w)-$),E=Math.floor((j.x+v-1)/b)+$,P=Math.floor((j.y+B-1)/w)+$;for(let e=H;e<=P;e++)for(let t=I;t<=E;t++)M.add(`${m}/${e}/${t}`)}d.forEach(((e,t)=>{if(!M.has(t)){const e=d.get(t);(null==e||e.isResolved||e.isRejected)&&d.delete(t)}})),m.extent={xmin:i.xmin,ymin:i.ymin,xmax:i.xmax,ymax:i.ymax}}export{h as decreaseRefCount,d as deleteBlock,f as deleteRaster,m as getBlock,i as getRasterId,x as putBlock,s as register,u as unregister,y as update};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{getInfo as n}from\"../../../geometry/support/spatialReferenceUtils.js\";import{project as t}from\"../../../geometry/support/webMercatorUtils.js\";import o from\"../../../geometry/Point.js\";import i from\"../../../geometry/Extent.js\";import\"../../../geometry.js\";import{getMetersPerUnitForSR as r}from\"../../../core/unitUtils.js\";import{isLoaded as a,isSupported as s,load as l,project as c}from\"../../../geometry/projection.js\";const x=function(e,n){const t=(e.isWGS84||e.isWebMercator)&&(n.isWGS84||n.isWebMercator);return!(e.equals(n)||t)},m=32;async function u(){if(a()||!s())return null;await l()}function p(n,o,r,s=null){if(n.spatialReference.equals(o))return n;const l=x(n.spatialReference,o);if(l&&!a())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");const m=r.center,u=new i({xmin:m.x-n.x/2,xmax:m.x+n.x/2,ymin:m.y-n.y/2,ymax:m.y+n.y/2,spatialReference:n.spatialReference}),p=l?c(u,o,s):t(u,o);if(null==p)return null;return{x:p.xmax-p.xmin,y:p.ymax-p.ymin}}function f(e,n=.01){return r(e)?n/r(e):0}function h(o,i,r=null,s=!0){const l=o.spatialReference;if(l.equals(i))return o;const m=x(l,i);if(m&&!a())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");const u=m?c(o,i,r):t(o,i);if(u&&s&&i.isGeographic){var p,h;const[e,t]=l.isWebMercator?n(l).origin:null!=(p=null==(h=n(l))?void 0:h.valid)?p:[],i=f(l);i&&null!=e&&null!=t&&(Math.abs(o.x-e)<i&&Math.abs(180-u.x)<5e-4?u.x-=360:Math.abs(o.x-t)<i&&Math.abs(180+u.x)<5e-4&&(u.x+=360))}return u}function y(i,r,s=null,l=!0){var m,u,p,y;const M=i.spatialReference;if(M.equals(r))return i;const w=x(M,r);if(w&&!a())throw new e(\"rasterprojectionhelper-projectExtent\",\"projection engine is not loaded\");const d=w?c(i,r,s):t(i,r);let[g,j]=null!=(m=null==(u=n(M))?void 0:u.origin)?m:[];if(d&&l&&M.isWebMercator&&r.isGeographic&&null!=g&&null!=j){const e=.001,n=1e3;if(Math.abs(i.xmin-g)<e&&Math.abs(j-i.xmax)>n&&Math.abs(180-d.xmax)<5e-4){d.xmin=-180;const e=[];e.push(new o(i.xmax,i.ymin,M)),e.push(new o(i.xmax,(i.ymin+i.ymax)/2,M)),e.push(new o(i.xmax,i.ymax,M));const n=e.map((e=>h(e,r,s))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));d.xmax=Math.max.apply(null,n)}if(Math.abs(i.xmax-j)<e&&Math.abs(g-i.xmin)>n&&Math.abs(180+d.xmin)<5e-4){d.xmax=180;const e=[];e.push(new o(i.xmin,i.ymin,M)),e.push(new o(i.xmin,(i.ymin+i.ymax)/2,M)),e.push(new o(i.xmin,i.ymax,M));const n=e.map((e=>h(e,r,s))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));d.xmin=Math.min.apply(null,n)}}[g,j]=r.isWebMercator?n(r).origin:null!=(p=null==(y=n(r))?void 0:y.valid)?p:[];const R=f(r);return R&&null!=g&&null!=j&&(Math.abs(d.xmin-g)<R&&(d.xmin=g),Math.abs(d.xmax-j)<R&&(d.xmax=j)),d}function M(t,i,r,s=null,l=null,c=!1,m=[32,32]){var u,p;if(x(t.spatialReference,i.spatialReference)&&!a())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");if(!(t&&i&&r))return null;const{xmin:f,ymin:y,xmax:M,ymax:w}=t,d=t.spatialReference,g=i.spatialReference,[j,R]=null!=(u=null==(p=n(d))?void 0:p.valid)?u:[],b={x:m[0]*r.x,y:m[1]*r.y},v={cols:Math.ceil((M-f)/b.x-.1)+1,rows:Math.ceil((w-y)/b.y-.1)+1},N=b.x,S=b.y,z=[];let W,G=!1;for(let e=0;e<v.cols;e++){const n=[];for(let t=0;t<v.rows;t++){let r=h(new o({x:f+N*e,y:w-S*t,spatialReference:d}),g,s);l&&(r=l.inverseTransform(r)),n.push(r),e>0&&c&&r&&W[t]&&null!=j&&r.x<W[t].x&&(r.x+=R-j),r?(z.push((r.x-i.xmin)/(i.xmax-i.xmin)),z.push((i.ymax-r.y)/(i.ymax-i.ymin))):(z.push(NaN),z.push(NaN),G=!0)}W=n}const P=function(e,n){const t=(e[0]+e[4]+e[4*n.cols]+e[4*n.cols+4])/4,o=(e[1]+e[5]+e[4*n.rows+1]+e[4*n.rows+5])/4;return[Math.abs(t-e[2*n.rows+2]),Math.abs(o-e[2*n.rows+3])]}(z,v),L=new Float32Array((v.cols-1)*(v.rows-1)*2*6),q=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),A=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let e=0;e<v.cols-1;e++){for(let n=0;n<v.rows-1;n++){let t=e*v.rows*2+2*n;const o=z[t],i=z[t+1],r=z[t+2],a=z[t+3];t+=2*v.rows;const s=z[t],l=z[t+1],c=z[t+2],x=z[t+3];let m=0,u=12*(n*(v.cols-1)+e);for(let e=0;e<3;e++)L[u++]=q[m++]*o+q[m++]*r+q[m++]*c;m=0;for(let e=0;e<3;e++)L[u++]=q[m++]*i+q[m++]*a+q[m++]*x;m=0;for(let e=0;e<3;e++)L[u++]=A[m++]*o+A[m++]*s+A[m++]*c;m=0;for(let e=0;e<3;e++)L[u++]=A[m++]*i+A[m++]*l+A[m++]*x}if(G)for(let e=0;e<L.length;e++)isNaN(L[e])&&(L[e]=-1)}return{offsets:z,error:P,coefficients:L,spacing:m,size:[v.cols-1,v.rows-1]}}function w(e,n,t){const i=Math.log(e.x/n.pixelSize.x)/Math.LN2,r=Math.log(e.y/n.pixelSize.y)/Math.LN2,a=n.storageInfo.maximumPyramidLevel||0;let s=\"down\"===t?Math.floor(Math.min(i,r)):\"up\"===t?Math.ceil(Math.max(i,r)):Math.round((i+r)/2),l=!1;s<0?s=0:s>a&&(l=s>a+3,s=a);const c=Math.pow(2,s);return{pyramidLevel:s,pyramidResolution:new o({x:c*n.nativePixelSize.x,y:c*n.nativePixelSize.y,spatialReference:n.spatialReference}),excessiveReading:l}}function d(e,n,t=512,i=!0){const{extent:a,spatialReference:s,pixelSize:l}=e,c=p(new o({x:l.x,y:l.y,spatialReference:s}),n,a);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null};const x=(c.x+c.y)/2,m=r(n),u=x*m*96*39.37,f=n.isGeographic?512/t*295828763.7958547:512/t*591657527.591555;let h=!1;if(i&&(n.isGeographic||n.isWebMercator)){const e=y(a,n);h=e.xmin*e.xmax<0}let M,w=u;const d=1.001;if(h){w=f;const e=w/(96*m*39.37);M=p(new o({x:e,y:e,spatialReference:n}),s,a)}else{M={x:l.x,y:l.y};const n=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);let t=0;for(;w<.5005*f&&t<n;)t++,w*=2,M.x*=2,M.y*=2;Math.max(w,f)/Math.min(w,f)<=d&&(w=f)}const g=[],j=[],R=Math.min(70.5310735,u)/d;for(;w>=R;)g.push(w),j.push({x:M.x,y:M.y}),w/=2,M.x/=2,M.y/=2;return{projectedPixelSize:c,scales:g,srcResolutions:j}}export{d as computeProjectedScales,m as defaultGridSpacing,M as getProjectionOffsetGrid,u as load,y as projectExtent,h as projectPoint,p as projectResolution,w as snapPyramid};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nexport default class{constructor(t=15e3,e=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=t,this._interval=Math.min(t,e)}decreaseRefCount(t,e){const s=t+\"/\"+e,r=this._cachedBlocks;if(r.has(s)){const t=r.get(s);return t.refCount--,t.refCount<=0&&(r.delete(s),t.controller&&t.controller.abort()),t.refCount}return 0}getBlock(t,e){const s=t+\"/\"+e,r=this._cachedBlocks;if(r.has(s)){const t=r.get(s);return t.ts=Date.now(),t.refCount++,r.delete(s),r.set(s,t),t.block}return null}putBlock(t,e,s,r=null){const i=this._cachedBlocks,c=t+\"/\"+e;if(i.has(c)){const t=i.get(c);t.ts=Date.now(),t.refCount++}else i.set(c,{block:s,ts:Date.now(),refCount:1,controller:r});this.trim(),this.updateTimer()}deleteBlock(t,e){const s=this._cachedBlocks,r=t+\"/\"+e;s.has(r)&&s.delete(r)}updateMaxSize(t){this._size=t,this.trim()}empty(){this._cachedBlocks.clear(),this.clearTimer()}getCurrentSize(){return this._cachedBlocks.size}updateTimer(){if(null!=this._timer)return;const t=this._cachedBlocks;this._timer=setInterval((()=>{const e=Array.from(t),s=Date.now();for(let r=0;r<e.length&&e[r][1].ts<=s-this._duration;r++)t.delete(e[r][0]);0===t.size&&this.clearTimer()}),this._interval)}trim(){const t=this._cachedBlocks;if(-1===this._size||this._size>=t.size)return;const e=Array.from(t);for(let s=0;s<e.length-this._size;s++)t.delete(e[s][0])}clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}\n"]}