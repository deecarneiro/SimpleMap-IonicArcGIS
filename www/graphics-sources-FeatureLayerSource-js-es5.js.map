{"version":3,"sources":["webpack:///node_modules/@arcgis/core/layers/graphics/sources/FeatureLayerSource.js","webpack:///node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js"],"names":["q","Set","I","arguments","type","e","t","signal","addResolvingPromise","_fetchService","layer","capabilities","query","supportsFormatPBF","r","parsedUrl","a","dynamicDataSource","s","gdbVersion","o","spatialReference","i","fieldsIndex","u","url","path","format","sourceSpatialReference","load","attributes","objectIdField","_getLayerRequestOptions","_getFormDataForAttachment","body","_createFeatureEditResult","data","addAttachmentResult","_createAttachmentErrorResult","attachmentId","updateAttachmentResult","addFeatures","map","_serializeFeature","updateFeatures","_getFeatureIds","deleteFeatures","deleteAttachments","addAttachments","_serializeAttachment","push","updateAttachments","n","length","adds","updates","deletes","l","method","JSON","stringify","join","rollbackOnFailure","rollbackOnFailureEnabled","useGlobalIds","globalIdUsed","attachments","d","_createEditsResult","attachmentIds","deleteAttachmentResults","then","returnUpdates","layerId","id","extent","fullExtent","timeExtent","fromJSON","start","end","get","objectIds","parentObjectId","attachmentInfos","queryTask","executeAttachmentQuery","execute","customParameters","executeJSON","executeForIds","executeForCount","executeForExtent","executeRelationshipQuery","executeRelationshipQueryForCount","sourceJSON","returnAdvancedSymbols","_patchServiceJSON","has","geometryType","drawingInfo","renderer","defaultSymbol","geometry","toJSON","feature","attachment","globalId","name","contentType","uploadId","parentGlobalId","globalIdField","FileReader","readAsDataURL","onload","result","onerror","mediaType","File","_getIdsFromFeatureIdentifier","_getIdsFromFeatures","objectId","addFeatureResults","addResults","updateFeatureResults","updateResults","deleteFeatureResults","deleteResults","addAttachmentResults","updateAttachmentResults","success","error","code","description","details","messages","message","httpStatus","messageCode","FormData","elements","set","append","source","f","responseType","prototype","constructOnly","readOnly","dependsOn","_","symbol","indexOf","Function"],"mappings":"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","file":"graphics-sources-FeatureLayerSource-js-es5.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/has.js\";import{fixJson as r}from\"../../../core/lang.js\";import{setDeepValue as a}from\"../../../core/object.js\";import{isSome as s,isNone as o}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as u}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../core/Error.js\";import{dataComponents as l}from\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{resolve as d,all as c,create as h}from\"../../../core/promiseUtils.js\";import y from\"../../../geometry/Extent.js\";import p from\"../../../request.js\";import m from\"../../../core/Loadable.js\";import f from\"../../../TimeExtent.js\";import{unapplyEditsZUnitScaling as g}from\"../../../tasks/operations/zscale.js\";import{processAttachmentQueryResult as b}from\"../../../tasks/operations/queryAttachments.js\";import F from\"../../../tasks/QueryTask.js\";import{createDrawingInfo as R}from\"./support/clientSideDefaults.js\";const q=new Set([\"Feature Layer\",\"Table\"]);let I=class extends m{constructor(){super(...arguments),this.type=\"feature-layer\"}load(e){const t=s(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),d(this)}get queryTask(){const{capabilities:{query:{supportsFormatPBF:e}},parsedUrl:r,dynamicDataSource:a,gdbVersion:s,spatialReference:o,fieldsIndex:i}=this.layer,u=t(\"featurelayer-pbf\")&&e?\"pbf\":\"json\";return new F({url:r.path,format:u,fieldsIndex:i,dynamicDataSource:a,gdbVersion:s,sourceSpatialReference:o})}async addAttachment(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/addAttachment\",s=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(t,s.query);try{const e=await p(a,{body:o});return this._createFeatureEditResult(e.data.addAttachmentResult)}catch(e){throw this._createAttachmentErrorResult(r,e)}}async updateAttachment(e,t,r){await this.load();const a=e.attributes[this.layer.objectIdField],s=this.layer.parsedUrl.path+\"/\"+a+\"/updateAttachment\",o=this._getLayerRequestOptions({query:{attachmentId:t}}),i=this._getFormDataForAttachment(r,o.query);try{const e=await p(s,{body:i});return this._createFeatureEditResult(e.data.updateAttachmentResult)}catch(e){throw this._createAttachmentErrorResult(a,e)}}async applyEdits(e,t){await this.load();const r=e.addFeatures.map(this._serializeFeature,this),a=e.updateFeatures.map(this._serializeFeature,this),s=this._getFeatureIds(e.deleteFeatures);g(r,a,this.layer.spatialReference);const o=[],i=[],u=[...e.deleteAttachments];for(const t of e.addAttachments)o.push(await this._serializeAttachment(t));for(const t of e.updateAttachments)i.push(await this._serializeAttachment(t));const n=o.length||i.length||u.length?{adds:o,updates:i,deletes:u}:null,l=this._getLayerRequestOptions({method:\"post\",query:{adds:r.length?JSON.stringify(r):null,updates:a.length?JSON.stringify(a):null,deletes:s.length?s.join(\",\"):null,gdbVersion:null==t?void 0:t.gdbVersion,rollbackOnFailure:null==t?void 0:t.rollbackOnFailureEnabled,useGlobalIds:null==t?void 0:t.globalIdUsed,attachments:n&&JSON.stringify(n)}}),d=await p(this.layer.parsedUrl.path+\"/applyEdits\",l);return this._createEditsResult(d)}async deleteAttachments(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/deleteAttachments\";try{return(await p(a,this._getLayerRequestOptions({query:{attachmentIds:t.join(\",\")},method:\"post\"}))).data.deleteAttachmentResults.map(this._createFeatureEditResult)}catch(e){throw this._createAttachmentErrorResult(r,e)}}fetchRecomputedExtents(e={}){const t=e.signal;return this.load({signal:t}).then((async()=>{const t=this._getLayerRequestOptions({...e,query:{returnUpdates:!0}}),{layerId:r,url:a}=this.layer,{data:s}=await p(`${a}/${r}`,t),{id:o,extent:i,fullExtent:u,timeExtent:n}=s,l=i||u;return{id:o,fullExtent:l&&y.fromJSON(l),timeExtent:n&&f.fromJSON({start:n[0],end:n[1]})}}))}async queryAttachments(e,t={}){const{parsedUrl:r}=this.layer,a=r.path;await this.load();const s=this._getLayerRequestOptions(t);if(!this.layer.get(\"capabilities.operations.supportsQueryAttachments\")){const{objectIds:t}=e,r=[];for(const e of t){const t=a+\"/\"+e+\"/attachments\";r.push(p(t,s))}return c(r).then((e=>t.map(((t,r)=>({parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}))))).then((e=>b(e,a)))}return this.queryTask.executeAttachmentQuery(e,s)}async queryFeatures(e,t){return await this.load(),this.queryTask.execute(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeaturesJSON(e,t){return await this.load(),this.queryTask.executeJSON(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryObjectIds(e,t){return await this.load(),this.queryTask.executeForIds(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeatureCount(e,t){return await this.load(),this.queryTask.executeForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryExtent(e,t){return await this.load(),this.queryTask.executeForExtent(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeatures(e,t){return await this.load(),this.queryTask.executeRelationshipQuery(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeaturesCount(e,t){return await this.load(),this.queryTask.executeRelationshipQueryForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async _fetchService(e){let r=this.layer.sourceJSON;if(!r){const{data:a}=await p(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:t(\"featurelayer-advanced-symbols\")?{returnAdvancedSymbols:!0}:{},signal:e}));r=a}this.sourceJSON=this._patchServiceJSON(r);const a=r.type;if(!q.has(a))throw new n(\"feature-layer-source:unsupported-type\",`Source type \"${a}\" is not supported`)}_patchServiceJSON(e){var t;if(\"Table\"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){const t=R(e.geometryType).renderer;a(\"drawingInfo.renderer\",t,e)}return e}_serializeFeature(e){const{geometry:t,attributes:r}=e;return o(t)?{attributes:r}:\"mesh\"===t.type||\"extent\"===t.type?null:{geometry:t.toJSON(),attributes:r}}async _serializeAttachment(e){const{feature:t,attachment:r}=e,{globalId:a,name:s,contentType:o,data:i,uploadId:u}=r,n={globalId:a,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(t&&(n.parentGlobalId=\"attributes\"in t?t.attributes&&t.attributes[this.layer.globalIdField]:t.globalId),u)n.uploadId=u;else if(i){const e=await async function(e){if(\"string\"==typeof e){return l(e)||{data:e}}return h(((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(l(a.result)),a.onerror=e=>r(e)}))}(i);n.contentType=e.mediaType,n.data=e.data,i instanceof File&&(n.name=i.name)}return s&&(n.name=s),o&&(n.contentType=o),n}_getFeatureIds(e){const t=e[0];return t?\"objectId\"in t?this._getIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}_getIdsFromFeatures(e){const t=this.layer.objectIdField;return e.map((e=>e.attributes&&e.attributes[t]))}_getIdsFromFeatureIdentifier(e){return e.map((e=>e.objectId))}_createEditsResult(e){const t=e.data,r=e.data&&e.data.attachments;return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new n(\"feature-layer-source:edit-failure\",t.description,{code:t.code}):null}}_createAttachmentErrorResult(e,t){const r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new n(\"feature-layer-source:attachment-failure\",r,{code:a})}}_getFormDataForAttachment(e,t){const r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(const e in t){const a=t[e];null!=a&&(r.set?r.set(e,a):r.append(e,a))}return r}_getLayerRequestOptions(e={}){const{parsedUrl:t,gdbVersion:a,dynamicDataSource:s}=this.layer;return{...e,query:r({gdbVersion:a,layer:s?JSON.stringify({source:s}):void 0,...t.query,f:\"json\",...this.layer.customParameters,...null==e?void 0:e.query}),responseType:\"json\"}}};e([i()],I.prototype,\"type\",void 0),e([i({constructOnly:!0})],I.prototype,\"layer\",void 0),e([i({readOnly:!0,dependsOn:[\"layer.parsedUrl\",\"layer.gdbVersion\",\"layer.dynamicDataSource\",\"layer.fieldsIndex\"]})],I.prototype,\"queryTask\",null),I=e([u(\"esri.layers.graphics.sources.FeatureLayerSource\")],I);var _=I;export default _;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/has.js\";import{clone as r}from\"../../../../core/lang.js\";import{defaultPointSymbolJSON as e,defaultPolylineSymbolJSON as n,defaultPolygonSymbolJSON as o}from\"../../../../symbols/support/defaultsJSON.js\";function i(t){return{renderer:{type:\"simple\",symbol:\"esriGeometryPoint\"===t||\"esriGeometryMultipoint\"===t?e:\"esriGeometryPolyline\"===t?n:o}}}function s(r,e){if(t(\"csp-restrictions\"))return()=>({[e]:null,...r});try{let t=`this.${e} = null;`;for(const e in r){t+=`this${e.indexOf(\".\")?`[\"${e}\"]`:`.${e}`} = ${JSON.stringify(r[e])};`}const n=new Function(t);return()=>new n}catch(t){return()=>({[e]:null,...r})}}function u(t={}){return[{name:\"New Feature\",description:\"\",prototype:{attributes:r(t)}}]}export{s as createDefaultAttributesFunction,u as createDefaultTemplate,i as createDrawingInfo};\n"]}