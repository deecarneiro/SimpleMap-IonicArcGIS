{"version":3,"sources":["webpack:///node_modules/@arcgis/core/views/2d/engine/webgl/TiledDisplayObject.js","webpack:///node_modules/@arcgis/core/views/2d/layers/WMTSLayerView2D.js","webpack:///node_modules/@arcgis/core/views/2d/engine/webgl/TileContainer.js"],"names":["r","s","t","e","triangleCountReportedInDebug","transforms","dvs","tileMat3","triangleCount","key","bounds","size","coordRange","texture","dispose","_coords","_bounds","o","i","resolution","pixelRatio","toScreenNoRotation","coords","n","h","a","d","displayViewMat3","f","arguments","_handles","_tileStrategy","_fetchQueue","_tileRequests","Map","layer","activeLayer","tileMatrixSetId","tileMatrixSet","_getTileMatrixSetBySpatialReference","id","pause","state","update","resume","notifyChange","tileInfo","spatialReference","fullExtent","clone","isWebMercator","isWGS84","_tileInfoView","tileInfoView","process","fetchTile","cachePolicy","acquireTile","releaseTile","add","watch","_refresh","removeAll","destroy","clear","requestUpdate","updateRequested","suspended","length","_bitmapView","createTile","bitmap","getTileCoords","x","y","getTileResolution","width","height","fulfilled","promise","push","then","source","once","addChild","set","get","abort","removeChild","level","row","col","reset","tiles","forEach","requestRender","view","tileMatrixSets","find","wkid","indexOf","dependsOn","prototype","readOnly","m","sortChildren","setStencilReference","requiredLevel","getClosestInfoForScale","scale","displayLevel","scaleToZoom","registerRenderPass","name","brushes","drawPhase","DEBUG","MAP","HIGHLIGHT","target","getStencilTarget","children","has","setTransform","stencilRef"],"mappings":"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","file":"layers-WMTSLayerView2D-js-es5.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{s,m as t}from\"../../../../chunks/mat3.js\";import o from\"../../tiling/TileKey.js\";import{c as i}from\"../../../../chunks/mat3f32.js\";import{DisplayObject as e}from\"../DisplayObject.js\";class r extends e{constructor(s,t,e,r=e){super(),this.triangleCountReportedInDebug=0,this.transforms={dvs:i(),tileMat3:i()},this.triangleCount=0,this.key=new o(s),this.bounds=t,this.size=e,this.coordRange=r}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}get coords(){return this._coords}get bounds(){return this._bounds}set bounds(s){this._coords=[s[0],s[3]],this._bounds=s}setTransform(o,i){const e=i/(o.resolution*o.pixelRatio),r=this.transforms.tileMat3,[n,h]=o.toScreenNoRotation([0,0],this.coords),a=this.size[0]/this.coordRange[0]*e,d=this.size[1]/this.coordRange[1]*e;s(r,a,0,0,0,d,0,n,h,1),t(this.transforms.dvs,o.displayViewMat3,r)}}export{r as TiledDisplayObject};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{isAbortError as s}from\"../../../core/promiseUtils.js\";import{geographicToWebMercator as r}from\"../../../geometry/support/webMercatorUtils.js\";import l from\"../../../core/Handles.js\";import{RefreshableLayerView as a}from\"../../layers/RefreshableLayerView.js\";import o from\"../tiling/TileInfoView.js\";import h from\"../tiling/TileQueue.js\";import n from\"../tiling/TileStrategy.js\";import u from\"../../layers/LayerView.js\";import{LayerView2DMixin as c}from\"./LayerView2D.js\";import{BitmapTileLayerView2D as p}from\"./BitmapTileLayerView2D.js\";const f=[102113,102100,3857,3785,900913];let d=class extends(a(p(c(u)))){constructor(){super(...arguments),this._handles=new l,this._tileStrategy=null,this._fetchQueue=null,this._tileRequests=new Map,this.layer=null}get tileMatrixSet(){if(this.layer.activeLayer.tileMatrixSetId)return this.layer.activeLayer.tileMatrixSet;const e=this._getTileMatrixSetBySpatialReference(this.layer.activeLayer);return e?(this.layer.activeLayer.tileMatrixSetId=e.id,e):null}hitTest(){return null}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume(),this.notifyChange(\"updating\")}attach(){const e=this.layer.activeLayer,t=this.tileMatrixSet;if(!t)return;const i=t.tileInfo.spatialReference;let s=e.fullExtent&&e.fullExtent.clone();i.isWebMercator?s=r(s):i.isWGS84||(s=t.fullExtent),this._tileInfoView=new o(t.tileInfo,s),this._fetchQueue=new h({tileInfoView:this._tileInfoView,process:e=>this.fetchTile(e)}),this._tileStrategy=new n({cachePolicy:\"keep\",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),this._handles.add(this.watch([\"layer.activeLayer.styleId\",\"tileMatrixSet\"],(()=>this._refresh()))),super.attach()}detach(){super.detach(),this._handles.removeAll(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}async doRefresh(){this.updateRequested||this.suspended||this._refresh()}isUpdating(){return this._fetchQueue.length>0}acquireTile(e){const t=this._bitmapView.createTile(e),i=t.bitmap;[i.x,i.y]=this._tileInfoView.getTileCoords([0,0],t.key),i.resolution=this._tileInfoView.getTileResolution(t.key),[i.width,i.height]=this._tileInfoView.tileInfo.size,this._tileInfoView.getTileCoords(i,t.key);const r={id:e.id,fulfilled:!1,promise:this._fetchQueue.push(t.key).then((e=>{t.bitmap.source=e,t.once(\"attach\",(()=>this.requestUpdate())),this._bitmapView.addChild(t)})).catch((e=>{s(e)||(t.bitmap.source=null,t.once(\"attach\",(()=>this.requestUpdate())),this._bitmapView.addChild(t))}))};return r.promise.finally((()=>r.fulfilled=!0)),this._tileRequests.set(t,r),this.requestUpdate(),t}releaseTile(e){const t=this._tileRequests.get(e);t.fulfilled||this._fetchQueue.abort(t.id),this._tileRequests.delete(e),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}async fetchTile(e){return this.layer.fetchTile(e.level,e.row,e.col)}canResume(){const e=super.canResume();return e?null!==this.tileMatrixSet:e}_refresh(){this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>{if(!e.bitmap.source)return;e.bitmap.source=null;const t={id:e.key.id,fulfilled:!1,promise:this._fetchQueue.push(e.key).then((t=>{e.bitmap.source=t,e.requestRender(),this.notifyChange(\"updating\")}))};t.promise.then((()=>t.fulfilled=!0),(()=>t.fulfilled=!0)),this._tileRequests.set(e,t)})),this.notifyChange(\"updating\")}_getTileMatrixSetBySpatialReference(e){const t=this.view.spatialReference;if(!e.tileMatrixSets)return null;let i=e.tileMatrixSets.find((e=>e.tileInfo.spatialReference.wkid===t.wkid));return!i&&t.isWebMercator&&(i=e.tileMatrixSets.find((e=>f.indexOf(e.tileInfo.spatialReference.wkid)>-1))),i}};e([t({dependsOn:[\"tileMatrixSet\"]})],d.prototype,\"suspended\",void 0),e([t({readOnly:!0,dependsOn:[\"view.spatialReference\",\"layer.activeLayer\"]})],d.prototype,\"tileMatrixSet\",null),d=e([i(\"esri.views.2d.layers.WMTSLayerView2D\")],d);var m=d;export default m;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{WGLDrawPhase as e}from\"./enums.js\";import r from\"./brushes/WGLBrushInfo.js\";import s from\"./brushes/WGLBrushStencil.js\";import t from\"./WGLContainer.js\";const n=(e,r)=>e.key.level-r.key.level!=0?e.key.level-r.key.level:e.key.row-r.key.row!=0?e.key.row-r.key.row:e.key.col-r.key.col;export default class extends t{constructor(e){super(),this._tileInfoView=e}renderChildren(e){this.sortChildren(n),this.setStencilReference(),super.renderChildren(e)}createRenderParams(e){const{state:r}=e;return{...super.createRenderParams(e),requiredLevel:this._tileInfoView.getClosestInfoForScale(r.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(r.scale)}}prepareRenderPasses(t){const n=t.registerRenderPass({name:\"stencil\",brushes:[s],drawPhase:e.DEBUG|e.MAP|e.HIGHLIGHT,target:()=>this.getStencilTarget()}),i=t.registerRenderPass({name:\"tileInfo\",brushes:[r],drawPhase:e.DEBUG,target:()=>this.children,has:\"esri-tiles-debug\"});return[...super.prepareRenderPasses(t),n,i]}getStencilTarget(){return this.children}updateTransforms(e){for(const r of this.children){const s=this._tileInfoView.getTileResolution(r.key);r.setTransform(e,s)}}setStencilReference(){let e=1;for(const r of this.children)r.stencilRef=e++}}export{n as sortByLevel};\n"]}