{"version":3,"sources":["./node_modules/@arcgis/core/views/2d/layers/features/processors/HeatmapProcessor.js"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACkuB,oBAAoB,0DAAC,CAAC,cAAc,2EAA2E,aAAa,6EAA6E,kBAAkB,+BAA+B,6BAA6B,gFAAC,6CAA6C,gBAAgB,qEAAqE,wBAAwB,+GAA+G,iDAAiD,6DAAC,iDAAiD,YAAY,wCAAwC,WAAW,eAAe,6DAAC,uCAAuC,GAAG,QAAQ,gHAAC,iCAAiC,iCAAiC,cAAc,6DAA6D,oBAAoB,EAAE,mBAAmB,4DAA4D,qBAAqB,MAAM,EAAE,8DAAC,EAAE,6FAAC,kEAAkE,QAAuB,gEAAC,EAAC","file":"processors-HeatmapProcessor-js-es2015.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import{isSome as t}from\"../../../../../core/maybe.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/accessorSupport/decorators/property.js\";import{subclass as r}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../../core/urlUtils.js\";import\"../../../../../core/uuid.js\";import\"../../../../../portal/support/resourceExtension.js\";import{diff as s}from\"../../../../../core/accessorSupport/diffUtils.js\";import{calculateHeatmapIntensityInfoReaders as o}from\"../../../../../renderers/support/heatmapUtils.js\";import i from\"./BaseProcessor.js\";let a=class extends i{constructor(){super(...arguments),this.type=\"heatmap\",this._tileKeyToFeatureSets=new Map}initialize(){this.handles.add([this.tileStore.on(\"update\",this.onTileUpdate.bind(this))])}async update(e,t){const r=t.schema.processors[0];if(\"heatmap\"!==r.type)return;s(this._schema,r)&&(e.mesh=!0,this._schema=r)}onTileUpdate(e){for(const t of e.removed)this._tileKeyToFeatureSets.delete(t.key.id)}async onTileData(e,r,s){this._tileKeyToFeatureSets.has(e.key.id)&&\"replace\"!==r.type||this._tileKeyToFeatureSets.set(e.key.id,new Map);const i=this._tileKeyToFeatureSets.get(e.key.id);t(r.addOrUpdate)&&i.set(r.addOrUpdate.instance,r);let a=r.end;if(i.forEach((e=>a=a||e.end)),!a)return;const p=[];i.forEach((e=>{t(e.addOrUpdate)&&p.push(e.addOrUpdate)}));const c=o(p,this._schema.mesh,512,512),n={tileKey:e.key.id,intensityInfo:c},d=[c.matrix];return this.remoteClient.invoke(\"tileRenderer.onTileData\",n,{...s,transferList:d})}onTileError(e,t,r){return this.remoteClient.invoke(\"tileRenderer.onTileError\",{tileKey:e.id,error:t},r)}};a=e([r(\"esri.views.2d.layers.features.processors.HeatmapProcessor\")],a);var p=a;export default p;\n"],"sourceRoot":"webpack:///"}