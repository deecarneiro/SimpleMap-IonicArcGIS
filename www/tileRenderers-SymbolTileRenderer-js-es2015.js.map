{"version":3,"sources":["./node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/support/WGLFeatureView.js","./node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/SymbolTileRenderer.js"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAC2Q,gBAAgB,4EAAC,CAAC,mBAAmB,wEAAwE,kBAAkB,kDAAkD,oDAAoD,wBAAwB,aAAa,gBAAgB,4EAAC,GAAG,sEAAsE,YAAY,MAAM,sBAAsB,6BAA6B,qCAAqC,mBAAmB,sBAAsB,gBAAgB,qHAAqH,iGAAiG,oBAAoB,iCAAiC,uBAAuB,8BAA8B,sBAAsB,0DAAC,+DAA+D,mEAAC,OAAO,mEAAC,aAAa,0BAA0B,yBAAyB,0DAAC,MAAM,0DAAC,MAAM,0DAAC,QAAQ,0DAAC,4FAA4F,kHAAkH,EAAE,iHAAiH,EAAE,iGAAiG,EAAE,0BAA0B,0BAA0B,0DAAC,MAAM,0DAAC,MAAM,0DAAC,QAAQ,0DAAC,0CAA0C,mEAAC,8CAA8C,sEAAsE,EAAE,EAAE,+CAA2E;;;;;;;;;;;;;ACJz+D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAC80B,oBAAoB,6DAAC,CAAC,WAAW,YAAY,0EAAC,8CAA8C,kCAAkC,aAAa,6DAA6D,aAAa,sCAAsC,oBAAoB,yGAAyG,kBAAkB,WAAW,0BAA0B,SAAS,qFAAC,kCAAkC,kBAAkB,2JAA2J,GAAG,EAAE,gGAAC,IAAI,8DAA8D,cAAc,kCAAkC,2FAA2F,eAAe,kCAAkC,oCAAoC,8BAA8B,qDAAqD,iBAAiB,6FAA6F,mBAAmB,iGAAiG,0BAA0B,6CAA6C,mBAAmB,sHAAsH,cAAc,wCAAwC,kFAAC,YAAY,iEAAC,MAAM,iGAAiG,eAAe,kMAAkM,EAAE,8DAAC,EAAE,6FAAC,uEAAuE,QAAuB,gEAAC,EAAC","file":"tileRenderers-SymbolTileRenderer-js-es2015.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{createResolver as e}from\"../../../../../../core/promiseUtils.js\";import{WGLDrawPhase as s}from\"../../../../engine/webgl/enums.js\";import{brushes as t}from\"../../../../engine/brushes.js\";import{FeatureContainer as i}from\"../../../../engine/FeatureContainer.js\";class a extends i{constructor(e,s,t){super(e),this._pointToCallbacks=new Map,this._layer=t,this._layerView=s}renderChildren(e){if(this.attributeView.update(),this.hasAnimation){e.painter.effects.integrate.draw(e,e.attributeView)}super.renderChildren(e)}hitTest(s,t){const i=[s,t],a=e();return this._pointToCallbacks.set(i,a),this.requestRender(),a.promise}doRender(e){const{minScale:s,maxScale:t}=this._layer,i=e.state.scale;i<=(s||1/0)&&i>=t&&super.doRender(e)}get hasAnimation(){return this.hasLabels}get hasLabels(){const e=this._layer.featureReduction,s=e&&\"cluster\"===e.type&&e.labelsVisible&&e.labelingInfo&&e.labelingInfo.length;return this._layer.labelingInfo&&this._layer.labelingInfo.length&&this._layer.labelsVisible||!!s}get labelsVisible(){return this._layer.labelsVisible}prepareRenderPasses(e){const i=e.registerRenderPass({name:\"label\",brushes:[t.label],target:()=>this.hasLabels?this.children:null,drawPhase:s.LABEL|s.LABEL_ALPHA}),a=e.registerRenderPass({name:\"geometry\",brushes:[t.fill,t.line,t.marker,t.text],target:()=>this.children,enableDefaultDraw:()=>!this._layerView.hasEffects,effects:[{apply:e.effects.outsideEffect,enable:()=>this._layerView.hasEffects,args:()=>this._layerView.effectLists.excluded},{apply:e.effects.insideEffect,enable:()=>this._layerView.hasEffects,args:()=>this._layerView.effectLists.included},{apply:e.effects.hittest,enable:()=>!!this._pointToCallbacks.size,args:()=>this._pointToCallbacks}]}),r=e.registerRenderPass({name:\"highlight\",brushes:[t.fill,t.line,t.marker,t.text],target:()=>this.children,drawPhase:s.HIGHLIGHT,enableDefaultDraw:()=>!1,effects:[{apply:e.effects.highlight,enable:()=>!!this._layerView.hasHighlight()}]});return[...super.prepareRenderPasses(e),a,r,i]}}export{a as WGLFeatureView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/accessorSupport/decorators/property.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../../core/urlUtils.js\";import\"../../../../../core/uuid.js\";import\"../../../../../portal/support/resourceExtension.js\";import{create as i}from\"../../../../../geometry/support/aaBoundingRect.js\";import{WGLTile as s}from\"../../../engine/webgl/WGLTile.js\";import{simplifyVVRenderer as r}from\"../support/rendererUtils.js\";import{convertVisualVariables as a}from\"./support/visualVariablesUtils.js\";import l from\"./BaseTileRenderer.js\";import{WGLFeatureView as o}from\"./support/WGLFeatureView.js\";let n=class extends l{install(e){const t=new o(this.tileInfoView,this.layerView,this.layer);this.featuresView=t,e.addChild(t)}uninstall(e){e.removeChild(this.featuresView),this.featuresView.destroy()}hitTest(e,t){return this.featuresView.hitTest(e,t)}supportsRenderer(e){return null!=e&&-1!==[\"simple\",\"class-breaks\",\"unique-value\",\"dot-density\",\"dictionary\"].indexOf(e.type)}onConfigUpdate(e){let t=null;if(\"visualVariables\"in e){const i=(r(e).visualVariables||[]).map((e=>{const t=e.clone();return\"normalizationField\"in e&&(t.normalizationField=null),e.valueExpression&&\"$view.scale\"!==e.valueExpression&&(t.valueExpression=null,t.field=\"nop\"),t}));t=a(i)}this.featuresView.setRendererInfo(e,t,this.layerView.effects)}onTileData(e){const t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileData(t,e.data),this.layerView.view.labelManager.requestUpdate()}onTileError(e){const t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileError(t)}forceAttributeTextureUpload(){this.featuresView.attributeView.forceTextureUpload()}lockGPUUploads(){this.featuresView.attributeView.lockTextureUpload(),this.tiles.forEach((e=>e.lockUploads()))}unlockGPUUploads(){this.featuresView.attributeView.unlockTextureUpload(),this.tiles.forEach((e=>e.unlockUploads()))}async getMaterialItems(e){return this.featuresView.getMaterialItems(e)}invalidateLabels(){this.featuresView.hasLabels&&(this.tiles.forEach((e=>e.isDirty=!0)),this.layerView.view.labelManager.requestUpdate())}createTile(e){const t=this.tileInfoView.getTileBounds(i(),e),r=new s(e,t);return this.featuresView.hasLabels&&this.layerView.view.labelManager.addTile(this.layerView,r),r}disposeTile(e){this.featuresView.removeChild(e),this.featuresView.hasLabels&&this.layerView.view.labelManager.removeTile(this.layerView,e.key.id),e.destroy(),this.layerView.view.labelManager.requestUpdate()}};n=e([t(\"esri.views.2d.layers.features.tileRenderers.SymbolTileRenderer\")],n);var u=n;export default u;\n"],"sourceRoot":"webpack:///"}