{"version":3,"sources":["webpack:///node_modules/@arcgis/core/layers/graphics/editingSupport.js"],"names":["o","e","t","a","capabilities","operations","supportsEditing","editingEnabled","u","r","l","y","edits","result","m","emit","s","load","applyEdits","type","layer","addFeatures","updateFeatures","deleteFeatures","d","addAttachments","updateAttachments","deleteAttachments","data","isVersioned","gdbVersion","editing","supportsRollbackOnFailure","rollbackOnFailureEnabled","supportsGlobalId","globalIdUsed","isCollection","toArray","length","supportsAdd","supportsUpdate","supportsDelete","map","c","forEach","p","h","concat","geometry","i","slice","results","addFeatureResults","updateFeatureResults","deleteFeatureResults","addAttachmentResults","updateAttachmentResults","deleteAttachmentResults","filter","error","f","addedFeatures","updatedFeatures","deletedFeatures","addedAttachments","updatedAttachments","deletedAttachments","attributes","globalIdField","globalId","hasZ","supportsZ","hasM","supportsM","feature","attachment","uploadId","File","name","supportsUploadWithItemId","isBase64"],"mappings":"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","file":"graphics-editingSupport-js-es5.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{clone as e}from\"../../core/lang.js\";import{isSome as t}from\"../../core/maybe.js\";import a from\"../../core/Error.js\";import{dataComponents as r}from\"../../core/urlUtils.js\";import{create as s,reject as d}from\"../../core/promiseUtils.js\";import i from\"../../core/Collection.js\";import l from\"../../Graphic.js\";import{normalizeCentralMeridian as n}from\"../../geometry/support/normalizeUtils.js\";function o(e){var t,a;return!0===(null==e||null==(t=e.capabilities)||null==(a=t.operations)?void 0:a.supportsEditing)&&e&&(!(\"editingEnabled\"in e)||e.editingEnabled)}async function u(t,r,l,o){let u,m;const y={edits:l,result:s(((e,t)=>{u=e,m=t}))};t.emit(\"apply-edits\",y);try{const{results:s,edits:m}=await async function(e,t,r,s){if(await e.load(),!function(e){return e&&null!=e.applyEdits}(t))return d(new a(`${e.type}-layer:no-editing-support`,\"Layer source does not support applyEdits capability\",{layer:e}));if(!e.editingEnabled)throw new a(`${e.type}-layer:editing-disabled`,\"Editing is disabled for layer\",{layer:e});const l=await function(e,t,r){const s=t&&(t.addFeatures||t.updateFeatures||t.deleteFeatures),d=t&&(t.addAttachments||t.updateAttachments||t.deleteAttachments);if(!t||!s&&!d)throw new a(`${e.type}-layer:missing-parameters`,\"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required\");if(!e.capabilities.data.isVersioned&&r&&r.gdbVersion)throw new a(`${e.type}-layer:invalid-parameter`,\"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'\");if(!e.capabilities.editing.supportsRollbackOnFailure&&r&&r.rollbackOnFailureEnabled)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'\");if(!e.capabilities.editing.supportsGlobalId&&r&&r.globalIdUsed)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'\");if(!e.capabilities.editing.supportsGlobalId&&d)throw new a(`${e.type}-layer:invalid-parameter`,\"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'\");if((!r||!r.globalIdUsed)&&d)throw new a(`${e.type}-layer:invalid-parameter`,\"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true\");const l={...t};if(l.addFeatures=t&&i.isCollection(t.addFeatures)?t.addFeatures.toArray():l.addFeatures||[],l.updateFeatures=t&&i.isCollection(t.updateFeatures)?t.updateFeatures.toArray():l.updateFeatures||[],l.deleteFeatures=t&&i.isCollection(t.deleteFeatures)?t.deleteFeatures.toArray():l.deleteFeatures||[],l.addFeatures.length&&!e.capabilities.operations.supportsAdd)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support adding features.\");if(l.updateFeatures.length&&!e.capabilities.operations.supportsUpdate)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support updating features.\");if(l.deleteFeatures.length&&!e.capabilities.operations.supportsDelete)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support deleting features.\");l.addAttachments=l.addAttachments||[],l.updateAttachments=l.updateAttachments||[],l.deleteAttachments=l.deleteAttachments||[],l.addFeatures=l.addFeatures.map(c),l.updateFeatures=l.updateFeatures.map(c);const o=r&&r.globalIdUsed;return l.addFeatures.forEach((t=>p(t,e,o))),l.updateFeatures.forEach((t=>p(t,e,o))),l.deleteFeatures.forEach((t=>p(t,e,o))),l.addAttachments.forEach((t=>h(t,e))),l.updateAttachments.forEach((t=>h(t,e))),async function(e){const t=e.addFeatures,a=e.updateFeatures,r=t.concat(a).map((e=>e.geometry)),s=await n(r),d=t.length,i=a.length;return s.slice(0,d).forEach(((t,a)=>{e.addFeatures[a].geometry=t})),s.slice(d,d+i).forEach(((t,a)=>{e.updateFeatures[a].geometry=t})),e}(l)}(e,r,s);if(!(l.addFeatures.length||l.updateFeatures.length||l.deleteFeatures.length||l.addAttachments.length||l.updateAttachments.length||l.deleteAttachments.length))return{edits:l,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}};return{edits:l,results:await t.applyEdits(l,s)}}(t,r,l,o),y=t=>t.filter((e=>!e.error)).map(e),f={edits:m,addedFeatures:y(s.addFeatureResults),updatedFeatures:y(s.updateFeatureResults),deletedFeatures:y(s.deleteFeatureResults),addedAttachments:y(s.addAttachmentResults),updatedAttachments:y(s.updateAttachmentResults),deletedAttachments:y(s.deleteAttachmentResults)};return(f.addedFeatures.length||f.updatedFeatures.length||f.deletedFeatures.length||f.addedAttachments.length||f.updatedAttachments.length||f.deletedAttachments.length)&&t.emit(\"edits\",f),u(f),s}catch(e){throw m(e),e}}function p(e,r,s){if(s){if(\"attributes\"in e&&!e.attributes[r.globalIdField])throw new a(`${r.type}-layer:invalid-parameter`,\"Feature should have 'globalId' when 'globalIdUsed' is true\");if(!(\"attributes\"in e)&&!e.globalId)throw new a(`${r.type}-layer:invalid-parameter`,\"'globalId' of the feature should be passed when 'globalIdUsed' is true\")}if(\"geometry\"in e&&t(e.geometry)){if(e.geometry.hasZ&&!1===r.capabilities.data.supportsZ)throw new a(`${r.type}-layer:z-unsupported`,\"Layer does not support z values while feature has z values.\");if(e.geometry.hasM&&!1===r.capabilities.data.supportsM)throw new a(`${r.type}-layer:m-unsupported`,\"Layer does not support m values while feature has m values.\")}}function h(e,t){const{feature:s,attachment:d}=e;if(!s||\"attributes\"in s&&!s.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to a feature with 'globalId'\");if(!(\"attributes\"in s)&&!s.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to 'globalId' of the parent feature\");if(!d.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'globalId'\");if(!d.data&&!d.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'data' or 'uploadId'\");if(!(d.data instanceof File&&!!d.data.name)&&!d.name)throw new a(`${t.type}-layer:invalid-parameter`,\"'name' is required when attachment is specified as Base64 encoded string using 'data'\");if(!t.capabilities.editing.supportsUploadWithItemId&&d.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'\");if(\"string\"==typeof d.data){const e=r(d.data);if(e&&!e.isBase64)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment 'data' should be a Blob, File or Base64 encoded string\")}}function c(e){const t=new l;return e.attributes||(e.attributes={}),t.geometry=e.geometry,t.attributes=e.attributes,t}export{u as applyEdits,o as isEditableLayer};\n"]}