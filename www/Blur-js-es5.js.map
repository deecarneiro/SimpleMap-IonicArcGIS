{"version":3,"sources":["webpack:///node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/Blur.js"],"names":["r","s","i","_blurFBO","_size","_programDesc","gaussianBlur","vsPath","fsPath","attributes","a_position","radialBlur","blit","dispose","t","context","a","type","n","radius","_createOrResizeResources","_quad","o","bind","_gaussianBlur","_radialBlur","unbind","e","state","painter","l","pixelRatio","u","size","d","materialManager","b","c","h","Math","round","p","_","getProgram","name","value","ceil","bindProgram","setBlendingEnabled","bindFramebuffer","bindTexture","colorTexture","setUniform1i","setUniform2fv","setUniform1f","draw","setStencilWriteMask","setStencilTestEnabled","setDepthWriteEnabled","setDepthTestEnabled","setBlendFunction","resize","colorTarget","depthStencilTarget","width","height","target","pixelFormat","internalFormat","dataType","wrapMode","samplingMode","flipped"],"mappings":"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","file":"Blur-js-es5.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport\"../../../../../../core/has.js\";import\"../../../../../../core/mathUtils.js\";import\"../../../../../../chunks/builtins.js\";import t from\"../../../../../webgl/FramebufferObject.js\";import\"../../../../../webgl/RenderingContext.js\";import e from\"../../VertexStream.js\";const r=[1,0],s=[0,1];class i{constructor(){this._blurFBO=null,this._size=[0,0],this._programDesc={gaussianBlur:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blur/gaussianBlur\",attributes:{a_position:0}},radialBlur:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blur/radial-blur\",attributes:{a_position:0}},blit:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blit\",attributes:{a_position:0}}}}dispose(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)}draw(t,r,s){const{context:i}=t,{type:a,radius:n}=s;if(0===n)return;this._createOrResizeResources(t),this._quad||(this._quad=new e(i,[-1,-1,1,-1,-1,1,1,1]));const o=this._quad;o.bind(),\"blur\"===a?this._gaussianBlur(t,r,n):this._radialBlur(t,r),o.unbind()}_gaussianBlur(t,e,i){const{context:a,state:n,painter:o,pixelRatio:l}=t,{size:u}=n,{materialManager:d}=o,b=this._programDesc,c=this._quad,h=[Math.round(l*u[0]),Math.round(l*u[1])],p=this._blurFBO,_=d.getProgram(t,b.gaussianBlur,[{name:\"radius\",value:Math.ceil(i)}]);a.bindProgram(_),a.setBlendingEnabled(!1),a.bindFramebuffer(p),a.bindTexture(e.colorTexture,4),_.setUniform1i(\"u_colorTexture\",4),_.setUniform2fv(\"u_texSize\",h),_.setUniform2fv(\"u_direction\",r),_.setUniform1f(\"u_sigma\",i),c.draw(),a.bindFramebuffer(e),a.setStencilWriteMask(0),a.setStencilTestEnabled(!1),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.bindTexture(p.colorTexture,5),_.setUniform1i(\"u_colorTexture\",5),_.setUniform2fv(\"u_direction\",s),c.draw(),a.setBlendingEnabled(!0),a.setBlendFunction(1,771),a.setStencilTestEnabled(!0)}_radialBlur(t,e){const{context:r,painter:s}=t,{materialManager:i}=s,a=this._programDesc,n=this._quad,o=this._blurFBO;r.bindFramebuffer(o);const l=i.getProgram(t,a.radialBlur);r.bindProgram(l),r.setBlendingEnabled(!1),r.bindTexture(e.colorTexture,4),l.setUniform1i(\"u_colorTexture\",4),n.draw(),r.bindFramebuffer(e),r.setStencilWriteMask(0),r.setStencilTestEnabled(!1),r.setDepthWriteEnabled(!1),r.setDepthTestEnabled(!1),r.setBlendingEnabled(!0);const u=i.getProgram(t,a.blit);r.bindProgram(u),r.bindTexture(o.colorTexture,5),u.setUniform1i(\"u_texture\",5),r.setBlendFunction(1,771),n.draw()}_createOrResizeResources(e){const{context:r,state:s,pixelRatio:i}=e,{size:a}=s,n=Math.round(i*a[0]),o=Math.round(i*a[1]);this._blurFBO&&this._size[0]===n&&this._size[1]===o||(this._size[0]=n,this._size[1]=o,this._blurFBO?this._blurFBO.resize(n,o):this._blurFBO=new t(r,{colorTarget:0,depthStencilTarget:0,width:n,height:o},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:n,height:o}))}}export{i as Blur};\n"]}